@model PikaCore.Models.ManageViewModels.AdminPanelViewModel

@{
    ViewData["Title"] = "Panel";
    var msg = ViewData["returnMessage"];
}

<h2>@ViewData["Title"]</h2>

@await Html.PartialAsync("_StatusMessage", msg)

<div id="downloadPartialDiv">
    @await Html.PartialAsync("_GeneratePasswordViewPartial.cshtml")
</div>

<ul class="collapsible">
    <li>
        <div class="collapsible-header">
            <a class="nav-link teal-text" href="#">Users</a>
        </div>
        <div class="collapsible-body">
            <div class="row" style="padding-top: 10px; padding-bottom: 10px; font-weight: bold;">
                <div class="col s5">
                    Username
                </div>
                <div class="col s3">
                    Permission level
                </div>
                <div class="col s4">
                    Options
                </div>
            </div>
            <div class="div-table">
                @foreach (var (key, value) in Model.UsersWithRoles)
                {
                    var roleString = "";
                    value.ToList().ForEach(role =>
                    {
                        roleString = string.Concat(roleString, " ", role);
                    });

                    <div class="row">
                        <div class="col s5 truncate">
                            @Html.DisplayFor(modelItem => key.UserName)
                        </div>
                        <div class="col s3">

                            @Html.DisplayFor(modelItem => roleString)
                        </div>
                        <div class="col s4">
                            <a class="teal-text" asp-action="Edit" asp-controller="Admin" asp-route-id=@key.Id><i class="fas fa-pen"></i></a>
                            <a class="teal-text" asp-action="Delete" asp-controller="Admin" asp-route-id="@key.Id"><i class="fas fa-trash-alt"></i></a>
                            <a class="teal-text" asp-action="GeneratePassword" asp-controller="Admin" asp-route-id="@key.Id"><i class="fas fa-key"></i></a>
                        </div>
                    </div>
                }
            </div>
        </div>
    </li>
    <li>
        <div class="collapsible-header">
            <a class="nav-link teal-text" href="#">Logs</a>
        </div>
        <div class="collapsible-body log-area">
            @await Html.PartialAsync("_LogsViewPartial.cshtml", Model.LogsListViewModel)
        </div>
    </li>
</ul>

@section Scripts {
    @await Html.PartialAsync("_ValidationScriptsPartial")
}
